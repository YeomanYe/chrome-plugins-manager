(function(){document.title=chrome.i18n.getMessage("extName");$("#tips").attr("data-lan",chrome.i18n.getMessage("@@ui_locale"));$("#tips .title").html(chrome.i18n.getMessage("tipsTitle"));
$("#tips .con").html(chrome.i18n.getMessage("tipsCon"));$("#rightMenu li.option").html(chrome.i18n.getMessage("rightOption"));$("#rightMenu li.uninstall").html(chrome.i18n.getMessage("rightUninstall"));
$("#rightMenu li.homepage").html(chrome.i18n.getMessage("rightHomepage"));var b=$("#tips .url");b.html(chrome.i18n.getMessage("tipsUrl"));b.attr("href",b.attr("href")+chrome.i18n.getMessage("@@ui_locale"));
var d=$("#showList");var n=$("#hideList");var f=$("#wrap");var j=localStorage.getItem("_switch_show_extname_")!=="close";var q=localStorage.getItem("_switch_right_more_")!=="close";
var k=$("#extName");var h=$("#rightMenu");var i={3:228,4:304,5:380,6:456,7:532,8:608,9:684};f.width(i[localStorage.getItem("_showColumn_")]);var p=localStorage.getItem("_showIconSize_")||2;
f.addClass("icon-size-"+p);function o(){var s=l();chrome.management.getAll(function(A){var t=[];var C=[];var u=[];for(var w=0;w<A.length;w++){var v=A[w];
if(v.id===chrome.app.getDetails().id||v.type==="theme"){continue;}var x="";if(v.icons){x=v.icons[v.icons.length-1].url;}var y="";if(s&&s[v.id]==1){y="locked";
}var B="";if(!v.icons||v.icons.length==0){B="noicon";}var z='<li class="'+B+'" data-id="'+v.id+'" data-homepageurl="'+v.homepageUrl+'" data-optionurl="'+v.optionsUrl+'" data-name="'+v.shortName+'" style="background-image:url('+x+')" '+y+"></li>";
if(j&&v.icons&&v.icons.length>0){(function(E,F){setTimeout(function(){a(E,F.id);},0);})(v.icons[0].url,v);}if(v.enabled===false){u.push(z);}else{if(y==="locked"){C.unshift(z);
}else{t.push(z);}}}if(!localStorage.getItem("_switch_rank_sort_")){t.sort(function(E,F){return r.get($(F).data("id"))-r.get($(E).data("id"));});u.sort(function(E,F){return r.get($(F).data("id"))-r.get($(E).data("id"));
});}var D=C.concat(t);d.html(D.join(""));if(u.length===0){d.addClass("hideListIsNull");if(D.length===0){f.addClass("allListIsEmpty");}}n.html(u.join(""));
setTimeout(function(){$("body").css("background-color","#fff");f.height(f.height()+1);},200);m();});}o();function m(){if(!localStorage.getItem("_switch_show_badge_")){var t=l();
var s=0;$("#showList li").each(function(u,v){var w=$(v).data("id");if(t&&t[w]!=="1"){s++;}});if(s===0){chrome.browserAction.setBadgeText({text:""});}else{chrome.browserAction.setBadgeBackgroundColor({color:"#f44336"});
chrome.browserAction.setBadgeText({text:s+""});}}}var r={_key:"_rankList_",_getLocalStorage:function(){var t=localStorage.getItem(this._key),s=null;if(t){s=JSON.parse(t);
return s;}else{return{};}},_setLocalStorage:function(s){localStorage.setItem(this._key,JSON.stringify(s));},get:function(t){var s=this._getLocalStorage();
if(s&&s[t]){return parseInt(s[t]);}else{return 0;}},setRank:function(u){var s=this._getLocalStorage();if(s){var t=s[u];if(t){s[u]=parseInt(s[u])+1;}else{s[u]=1;
}this._setLocalStorage(s);}}};f.on("click","li",function(v){v.preventDefault();v.stopPropagation();var u=$(this),w=u.data("id"),s=u.closest("#hideList").length===1;
if(w){u.removeClass("hover");k.removeClass("extName-anim").attr("style","").empty();if(s){d.append(u);r.setRank(w);}else{n.append(u);}u.attr("data-leftClick",(new Date)*1);
if(n.find("li").length===0){d.addClass("hideListIsNull");}else{d.removeClass("hideListIsNull");}chrome.management.setEnabled(w,s,function(){});}m();});
function c(){var s=$("[data-right]");if(s.length>0){s.removeAttr("data-right").removeClass("hover");h.removeAttr("style");$(".dinginess").removeClass("dinginess");
}k.removeClass("extName-anim").attr("style","").empty();}$("body").on("click",function(){c();});var g={"1":14,"2":18,"3":24};f.on("mouseenter","li",function(){var B=$(this),s=B.attr("data-id");
var v=$("[data-right]"),A=v.attr("data-id");if(s===A){return false;}if(v.length>0){v.removeAttr("data-right").removeClass("hover");h.removeAttr("style");
var z=B.closest("#showList").length>0?$("#hideList"):$("#showList");z.removeClass("dinginess");}if(j){var C=B.offset();var w=C.left+50-10;var y=w+g[p];
var u=k.html(B.attr("data-name")).outerWidth();if($("body").width()<u+y){w=C.left-u+10;y=w-g[p];}if(e[s]){k.css("background-color",e[s].color);}k.css({top:C.top+15,left:w});
}var x=B.closest(".list");clearTimeout(window["timer_disable_dinginess_"+x.attr("id")]);window["timer_"+B.data("id")]=setTimeout(function(){if((new Date)*1<(B.attr("data-leftclick")*1+200)){return;
}B.addClass("hover");if(j){x.addClass("dinginess");k.addClass("extName-anim").css({left:y,opacity:1});}},100);}).on("mouseleave","li",function(){var s=$(this),u=s.closest(".list");
if(s.attr("data-right")!=undefined){return false;}if(j){window["timer_disable_dinginess_"+u.attr("id")]=setTimeout(function(){u.removeClass("dinginess");
},300);k.removeClass("extName-anim").attr("style","").empty();}s.removeClass("hover");clearTimeout(window["timer_"+s.data("id")]);});function l(){var s=localStorage.getItem("_lockList_");
if(s){return JSON.parse(s);}else{return null;}}$("body").on("dblclick",function(){var s=d.find("li");s.each(function(u,w){var v=$(w);var x=v.data("id");
if(v.attr("locked")===""){return;}n.append(v);chrome.management.setEnabled(x,false,function(){});});chrome.browserAction.setBadgeText({text:""});});$(document).on("mousedown","#hideList>li, #showList>li",function(w){var C=$(this),u=C.data("id"),s=C.attr("locked")!=undefined,z=C.data("optionurl"),y=C.data("homepageurl"),B=$("[data-right]");
if(B.length>0&&B.data("id")===u){c();}if(w.button===2&&C.hasClass("hover")&&q){k.removeClass("extName-anim").attr("style","").empty();C.attr("data-right","");
var D=C.offset();var v=D.left+0.15*50+50-10;var x=v+g[p];var A=h.outerWidth();if($("body").width()<A+x){v=D.left-A+10;x=v-g[p];}if(e[C.attr("data-id")]){h.css("background-color",e[C.attr("data-id")].color);
}h.css({top:D.top+(50*1.3-52)/2,left:v}).show();if(s){h.find("li.lock").attr("locked","");}else{h.find("li.lock").removeAttr("locked");}if(!!$.trim(z)){h.find("li.option").removeAttr("disabled");
}else{h.find("li.option").attr("disabled","");}if(!!$.trim(y)){h.find("li.homepage").removeAttr("disabled");}else{h.find("li.homepage").attr("disabled","");
}setTimeout(function(){h.css({left:x,opacity:1});},0);}});$(document).on("contextmenu",function(s){return false;});$("#rightMenu").on("click","li",function(w){w.preventDefault();
w.stopPropagation();var u=$(this),s=$("[data-right]"),x=s.attr("data-id");c();switch(u.attr("class")){case"lock":var v=l();if(u.attr("locked")===undefined){s.attr("locked","");
v[x]="1";}else{s.removeAttr("locked");delete v[x];}localStorage.setItem("_lockList_",JSON.stringify(v));break;case"option":if(u.attr("disabled")===undefined){chrome.tabs.create({url:s.data("optionurl")});
}break;case"homepage":if(u.attr("disabled")===undefined){chrome.tabs.create({url:s.data("homepageurl")});}break;case"uninstall":chrome.management.uninstall(x,function(){});
break;default:break;}});function l(){var s=localStorage.getItem("_lockList_");if(s){return JSON.parse(s);}else{return{};}}var e={};function a(v,t){function u(E){var z=document.getElementById("getColorByCanvas");
z.width=E.width;z.height=E.height;var y=z.getContext("2d");y.drawImage(E,0,0);var D=y.getImageData(0,0,E.width,E.height).data;var x=0;var F=0;var H=0;var C=180;
var J=1000;for(var K=0;K<E.height;K++){for(var B=0;B<E.width;B++){var A=D[((E.width*K)+B)*4];var w=D[((E.width*K)+B)*4+1];var I=D[((E.width*K)+B)*4+2];
if(A!=255&&w!=255&&I!=255){if(B<J){J=B;}}if(!(A>C&&w>C&&I>C)){x+=A;F+=w;H+=I;}}}x/=(E.width*E.height);F/=(E.width*E.height);H/=(E.width*E.height);x=Math.round(x);
F=Math.round(F);H=Math.round(H);var G="rgb("+x+","+F+","+H+")";if(x>C&&F>C&&H>C){G="#5c5e6f";}if(J===1000){setTimeout(function(){$("[data-id="+t+"]").addClass("noicon");
},0);}return{color:G,substantial:J};}var s=new Image();s.crossOrigin="Anonymous";s.src=v;s.onload=function(){var w=u(s);e[t]=w;};}})();