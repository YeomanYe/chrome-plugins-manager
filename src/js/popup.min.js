(function(){document.title=chrome.i18n.getMessage("extName");var p=$("body");var t=$(".js-dblclick-btn");var s=null;p.attr("data-lan",chrome.i18n.getMessage("@@ui_locale"));
$("#tips .title").html(chrome.i18n.getMessage("tipsTitle"));$("#tips .con").html(chrome.i18n.getMessage("tipsCon"));$("#rightMenu li.option").html(chrome.i18n.getMessage("rightOption"));
$("#rightMenu li.uninstall").html(chrome.i18n.getMessage("rightUninstall"));$("#rightMenu li.homepage").html(chrome.i18n.getMessage("rightHomepage"));var b=$("#tips .url");
b.html(chrome.i18n.getMessage("tipsUrl"));b.attr("href",b.attr("href")+chrome.i18n.getMessage("@@ui_locale"));var d=$("#showList");var q=$("#hideList");
var e=$("#wrap");var k=localStorage.getItem("_switch_show_extname_")!=="close";var w=localStorage.getItem("_switch_right_more_")!=="close";var l=$("#extName");
var h=$("#rightMenu");var z="#5c5e6f";var y="../icon/default-icon.png";var n=$(".js-searcher");var j={4:304,5:380,6:456,7:532,8:608,9:684};e.width(j[localStorage.getItem("_showColumn_")]);
var u=localStorage.getItem("_showIconSize_")||2;e.addClass("icon-size-"+u);function r(){var A=m();chrome.management.getAll(function(I){s=I;var B=[];var J=[];
var C=[];for(var E=0;E<I.length;E++){var D=I[E];if(D.id===chrome.app.getDetails().id||D.type==="theme"){continue;}var F="";if(D.icons&&D.icons.length>0){F=D.icons[D.icons.length-1].url;
}else{F=y;}var G="";if(A&&A[D.id]==1){G="locked";}var H='<li data-id="'+D.id+'" data-homepageurl="'+D.homepageUrl+'" data-optionurl="'+D.optionsUrl+'" data-name="'+D.shortName+'" style="background-image:url('+F+')" '+G+"></li>";
if(D.icons&&D.icons.length>0){(function(L,M){setTimeout(function(){a(L,M.id);},0);})(D.icons[0].url,D);}if(D.enabled===false){C.push(H);}else{if(G==="locked"){J.unshift(H);
}else{B.push(H);}}}if(!localStorage.getItem("_switch_rank_sort_")){B.sort(function(L,M){return x.get($(M).data("id"))-x.get($(L).data("id"));});C.sort(function(L,M){return x.get($(M).data("id"))-x.get($(L).data("id"));
});}var K=J.concat(B);d.html(K.join(""));if(C.length===0){d.addClass("hideListIsNull");if(K.length===0){e.addClass("allListIsEmpty");}}q.html(C.join(""));
setTimeout(function(){p.css("background-color","#fff");e.width(e.width()+1);},200);o();});}r();function o(){if(!localStorage.getItem("_switch_show_badge_")){var B=m();
var A=0;$("#showList li").each(function(C,D){var E=$(D).data("id");if(B&&B[E]!=="1"){A++;}});if(A===0){chrome.browserAction.setBadgeText({text:""});}else{chrome.browserAction.setBadgeBackgroundColor({color:"#f44336"});
chrome.browserAction.setBadgeText({text:A+""});}}}var x={_key:"_rankList_",_getLocalStorage:function(){var B=localStorage.getItem(this._key),A=null;if(B){A=JSON.parse(B);
return A;}else{return{};}},_setLocalStorage:function(A){localStorage.setItem(this._key,JSON.stringify(A));},get:function(B){var A=this._getLocalStorage();
if(A&&A[B]){return parseInt(A[B]);}else{return 0;}},setRank:function(C){var A=this._getLocalStorage();if(A){var B=A[C];if(B){A[C]=parseInt(A[C])+1;}else{A[C]=1;
}this._setLocalStorage(A);}}};e.on("click","li",function(C){C.preventDefault();var B=$(this),D=B.data("id"),A=B.closest("#hideList").length===1;if(D&&B.hasClass("hover")){B.removeClass("hover");
l.removeClass("extName-anim").attr("style","").empty();if(A){d.append(B);x.setRank(D);}else{q.append(B);}B.attr("data-leftClick",(new Date)*1);if(q.find("li").length===0){d.addClass("hideListIsNull");
}else{d.removeClass("hideListIsNull");}chrome.management.setEnabled(D,A,function(){});}o();});function c(){var A=$("[data-right]");if(A.length>0){A.removeAttr("data-right").removeClass("hover");
h.removeAttr("style");}$(".dinginess").removeClass("dinginess");l.removeClass("extName-anim").attr("style","").empty();}$(document).on("click",function(){c();
});var f={"1":18,"2":22,"3":26};e.on("mouseenter","li",function(){var L=$(this),P=L.attr("data-id");var M=$("[data-right]"),K=M.attr("data-id");if(e.attr("searching")!==undefined&&L.attr("searched")==undefined){return;
}if(P===K){return false;}if(M.length>0){M.removeAttr("data-right").removeClass("hover");h.removeAttr("style");var S=L.closest("#showList").length>0?$("#hideList"):$("#showList");
S.removeClass("dinginess");}var G="right";var O=L.offset();var I=O.left+50-10;var Q=I+f[u];var C=L.outerWidth();var N=L.outerHeight();var T=p.outerWidth();
var J=l.html(L.attr("data-name")).outerWidth();var D=h.outerWidth();var H=h.outerHeight();var A=Math.max(J,D);var F=T-O.left-C-f[u]+10;var B=O.left-f[u]+10;
var E=Math.max(B,F);if(A>F&&F<B){I=O.left-J+10;Q=I>f[u]?I-f[u]:0;G="left";}if(J>E){J=E-6;l.css({width:J,overflow:"hidden","text-overflow":"ellipsis"});
if(G=="left"){Q=Q+6;}}if(!v[P]){v[P]={};}v[P]["left1"]=I;v[P]["left2"]=Q;if(G=="left"){v[P]["left1"]=J>D?(I+(J-D)):(I-(D-J));v[P]["left2"]=J>D?(Q+(J-D)):(Q-(D-J));
}v[P]["top"]=H>N?O.top-(H-N)/2:O.top+(N-H)/2;if(v[P]){l.css("background-color",v[P].color);}l.css({top:O.top+15,left:I});var R=L.closest(".list");clearTimeout(window["timer_disable_dinginess_"+R.attr("id")]);
window["timer_"+L.data("id")]=setTimeout(function(){if((new Date)*1<(L.attr("data-leftclick")*1+200)){return;}L.addClass("hover");if(k){R.addClass("dinginess");
l.addClass("extName-anim").css({left:Q,opacity:1});}},100);}).on("mouseleave","li",function(){var A=$(this),B=A.closest(".list");if(A.attr("data-right")!=undefined){return false;
}if(k){window["timer_disable_dinginess_"+B.attr("id")]=setTimeout(function(){B.removeClass("dinginess");},300);l.removeClass("extName-anim").attr("style","").empty();
}A.removeClass("hover");clearTimeout(window["timer_"+A.data("id")]);});function m(){var A=localStorage.getItem("_lockList_");if(A){return JSON.parse(A);
}else{return null;}}var g=null;function i(){if(g){return;}g=setTimeout(function(){clearTimeout(g);g=null;},1000);var B=d.find("li");B.each(function(C,E){var D=$(E);
var F=D.data("id");if(D.attr("locked")===""){return;}q.append(D);chrome.management.setEnabled(F,false,function(){});});chrome.browserAction.setBadgeText({text:""});
var A=$("#showList li[locked]").removeAttr("locked");setTimeout(function(){A.attr("locked","");},0);}t.click(function(){i();});n.focus();n.on("input",function(){var E=$(this);
var F=E.val().trim().replace(/\s{2,}/g," ").toLowerCase();var B={};$("[searched]").removeAttr("searched");if(F){e.attr("searching","");var A=F.split(/\s/);
for(var D=s.length-1;D>=0;D--){for(var C=A.length-1;C>=0;C--){var G=(s[D].name+"  "+s[D].description).toLowerCase();if(G.indexOf(A[C])!==-1){B[s[D].id]=1;
}}}for(var H in B){$("[data-id="+H+"]").attr("searched","");}}else{e.removeAttr("searching");}}).hover(function(){$(this).select();},function(){});p.on("click",function(A){if(!$.contains(document.getElementById("searchBox"),A.target)){n.val("");
e.removeAttr("searching");}});$(".js-search-empty").on("click",function(){n.val("");e.removeAttr("searching");n.focus();});$(document).on("mousedown","#hideList>li, #showList>li",function(D){var C=$(this),G=C.data("id"),F=C.attr("locked")!=undefined,B=C.data("optionurl"),A=C.data("homepageurl"),E=$("[data-right]");
if(E.length>0&&E.data("id")===G){c();}if(D.button===2&&C.hasClass("hover")&&w){l.removeClass("extName-anim").attr("style","").empty();C.attr("data-right","");
h.css({"background-color":v[G]?v[G].color:z,top:v[G].top,left:v[G].left1}).show();if(F){h.find("li.lock").attr("locked","");}else{h.find("li.lock").removeAttr("locked");
}if(!!$.trim(B)){h.find("li.option").removeAttr("disabled");}else{h.find("li.option").attr("disabled","");}if(!!$.trim(A)){h.find("li.homepage").removeAttr("disabled");
}else{h.find("li.homepage").attr("disabled","");}setTimeout(function(){h.css({left:v[G].left2,opacity:1});},0);}});$(document).on("contextmenu",function(A){return false;
});$("#rightMenu").on("click","li",function(D){D.preventDefault();D.stopPropagation();var B=$(this),A=$("[data-right]"),E=A.attr("data-id");c();switch(B.attr("class")){case"lock":var C=m();
if(B.attr("locked")===undefined){A.attr("locked","");C[E]="1";}else{A.removeAttr("locked");delete C[E];}localStorage.setItem("_lockList_",JSON.stringify(C));
o();break;case"option":if(B.attr("disabled")===undefined){chrome.tabs.create({url:A.data("optionurl")});}break;case"homepage":if(B.attr("disabled")===undefined){chrome.tabs.create({url:A.data("homepageurl")});
}break;case"uninstall":chrome.management.uninstall(E,function(){});break;default:break;}});function m(){var A=localStorage.getItem("_lockList_");if(A){return JSON.parse(A);
}else{return{};}}var v={};function a(D,B){function C(M){var H=document.getElementById("getColorByCanvas");H.width=M.width;H.height=M.height;var G=H.getContext("2d");
G.drawImage(M,0,0);var L=G.getImageData(0,0,M.width,M.height).data;var F=0;var N=0;var P=0;var K=180;var R=1000;for(var S=0;S<M.height;S++){for(var J=0;
J<M.width;J++){var I=L[((M.width*S)+J)*4];var E=L[((M.width*S)+J)*4+1];var Q=L[((M.width*S)+J)*4+2];if(I!=255&&E!=255&&Q!=255){if(J<R){R=J;}}if(!(I>K&&E>K&&Q>K)){F+=I;
N+=E;P+=Q;}}}F/=(M.width*M.height);N/=(M.width*M.height);P/=(M.width*M.height);F=Math.round(F);N=Math.round(N);P=Math.round(P);var O="rgb("+F+","+N+","+P+")";
if(F>K&&N>K&&P>K){O=z;}if(R===1000){setTimeout(function(){$("[data-id="+B+"]").css({"background-image":"url("+y+")"});},0);O=z;}return{color:O,substantial:R};
}var A=new Image();A.crossOrigin="Anonymous";A.src=D;A.onload=function(){var E=C(A);if(!v[B]){v[B]={};}v[B]["color"]=E.color;v[B]["substantial"]=E.substantial;
};}})();