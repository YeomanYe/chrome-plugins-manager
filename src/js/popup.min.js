(function(){document.title=chrome.i18n.getMessage("extName");$("body").attr("data-lan",chrome.i18n.getMessage("@@ui_locale"));$("#tips .title").html(chrome.i18n.getMessage("tipsTitle"));
$("#tips .con").html(chrome.i18n.getMessage("tipsCon"));$("#rightMenu li.option").html(chrome.i18n.getMessage("rightOption"));$("#rightMenu li.uninstall").html(chrome.i18n.getMessage("rightUninstall"));
$("#rightMenu li.homepage").html(chrome.i18n.getMessage("rightHomepage"));var b=$("#tips .url");b.html(chrome.i18n.getMessage("tipsUrl"));b.attr("href",b.attr("href")+chrome.i18n.getMessage("@@ui_locale"));
var d=$("#showList");var m=$("#hideList");var e=$("#wrap");var i=localStorage.getItem("_switch_show_extname_")!=="close";var q=localStorage.getItem("_switch_right_more_")!=="close";
var j=$("#extName");var g=$("#rightMenu");var t="#5c5e6f";var s="../icon/default-icon.png";var h={4:304,5:380,6:456,7:532,8:608,9:684};e.width(h[localStorage.getItem("_showColumn_")]);
var o=localStorage.getItem("_showIconSize_")||2;e.addClass("icon-size-"+o);function n(){var u=k();chrome.management.getAll(function(C){var v=[];var D=[];
var w=[];for(var y=0;y<C.length;y++){var x=C[y];if(x.id===chrome.app.getDetails().id||x.type==="theme"){continue;}var z="";if(x.icons&&x.icons.length>0){z=x.icons[x.icons.length-1].url;
}else{z=s;}var A="";if(u&&u[x.id]==1){A="locked";}var B='<li data-id="'+x.id+'" data-homepageurl="'+x.homepageUrl+'" data-optionurl="'+x.optionsUrl+'" data-name="'+x.shortName+'" style="background-image:url('+z+')" '+A+"></li>";
if(x.icons&&x.icons.length>0){(function(F,G){setTimeout(function(){a(F,G.id);},0);})(x.icons[0].url,x);}if(x.enabled===false){w.push(B);}else{if(A==="locked"){D.unshift(B);
}else{v.push(B);}}}if(!localStorage.getItem("_switch_rank_sort_")){v.sort(function(F,G){return r.get($(G).data("id"))-r.get($(F).data("id"));});w.sort(function(F,G){return r.get($(G).data("id"))-r.get($(F).data("id"));
});}var E=D.concat(v);d.html(E.join(""));if(w.length===0){d.addClass("hideListIsNull");if(E.length===0){e.addClass("allListIsEmpty");}}m.html(w.join(""));
setTimeout(function(){$("body").css("background-color","#fff");e.width(e.width()+1);},200);l();});}n();function l(){if(!localStorage.getItem("_switch_show_badge_")){var v=k();
var u=0;$("#showList li").each(function(w,x){var y=$(x).data("id");if(v&&v[y]!=="1"){u++;}});if(u===0){chrome.browserAction.setBadgeText({text:""});}else{chrome.browserAction.setBadgeBackgroundColor({color:"#f44336"});
chrome.browserAction.setBadgeText({text:u+""});}}}var r={_key:"_rankList_",_getLocalStorage:function(){var v=localStorage.getItem(this._key),u=null;if(v){u=JSON.parse(v);
return u;}else{return{};}},_setLocalStorage:function(u){localStorage.setItem(this._key,JSON.stringify(u));},get:function(v){var u=this._getLocalStorage();
if(u&&u[v]){return parseInt(u[v]);}else{return 0;}},setRank:function(w){var u=this._getLocalStorage();if(u){var v=u[w];if(v){u[w]=parseInt(u[w])+1;}else{u[w]=1;
}this._setLocalStorage(u);}}};e.on("click","li",function(w){w.preventDefault();var v=$(this),x=v.data("id"),u=v.closest("#hideList").length===1;if(x&&v.hasClass("hover")){v.removeClass("hover");
j.removeClass("extName-anim").attr("style","").empty();if(u){d.append(v);r.setRank(x);}else{m.append(v);}v.attr("data-leftClick",(new Date)*1);if(m.find("li").length===0){d.addClass("hideListIsNull");
}else{d.removeClass("hideListIsNull");}chrome.management.setEnabled(x,u,function(){});}l();});function c(){var u=$("[data-right]");if(u.length>0){u.removeAttr("data-right").removeClass("hover");
g.removeAttr("style");}$(".dinginess").removeClass("dinginess");j.removeClass("extName-anim").attr("style","").empty();}$(document).on("click",function(){c();
});var f={"1":18,"2":22,"3":26};e.on("mouseenter","li",function(){var F=$(this),J=F.attr("data-id");var G=$("[data-right]"),E=G.attr("data-id");if(J===E){return false;
}if(G.length>0){G.removeAttr("data-right").removeClass("hover");g.removeAttr("style");var M=F.closest("#showList").length>0?$("#hideList"):$("#showList");
M.removeClass("dinginess");}var A="right";var I=F.offset();var C=I.left+50-10;var K=C+f[o];var w=F.outerWidth();var H=F.outerHeight();var N=$("body").outerWidth();
var D=j.html(F.attr("data-name")).outerWidth();var x=g.outerWidth();var B=g.outerHeight();var u=Math.max(D,x);var z=N-I.left-w-f[o]+10;var v=I.left-f[o]+10;
var y=Math.max(v,z);if(u>z&&z<v){C=I.left-D+10;K=C>f[o]?C-f[o]:0;A="left";}if(D>y){D=y-6;j.css({width:D,overflow:"hidden","text-overflow":"ellipsis"});
if(A=="left"){K=K+6;}}if(!p[J]){p[J]={};}p[J]["left1"]=C;p[J]["left2"]=K;if(A=="left"){p[J]["left1"]=D>x?(C+(D-x)):(C-(x-D));p[J]["left2"]=D>x?(K+(D-x)):(K-(x-D));
}p[J]["top"]=B>H?I.top-(B-H)/2:I.top+(H-B)/2;if(p[J]){j.css("background-color",p[J].color);}j.css({top:I.top+15,left:C});var L=F.closest(".list");clearTimeout(window["timer_disable_dinginess_"+L.attr("id")]);
window["timer_"+F.data("id")]=setTimeout(function(){if((new Date)*1<(F.attr("data-leftclick")*1+200)){return;}F.addClass("hover");if(i){L.addClass("dinginess");
j.addClass("extName-anim").css({left:K,opacity:1});}},100);}).on("mouseleave","li",function(){var u=$(this),v=u.closest(".list");if(u.attr("data-right")!=undefined){return false;
}if(i){window["timer_disable_dinginess_"+v.attr("id")]=setTimeout(function(){v.removeClass("dinginess");},300);j.removeClass("extName-anim").attr("style","").empty();
}u.removeClass("hover");clearTimeout(window["timer_"+u.data("id")]);});function k(){var u=localStorage.getItem("_lockList_");if(u){return JSON.parse(u);
}else{return null;}}$("body").on("dblclick",function(){var v=d.find("li");v.each(function(w,y){var x=$(y);var z=x.data("id");if(x.attr("locked")===""){return;
}m.append(x);chrome.management.setEnabled(z,false,function(){});});chrome.browserAction.setBadgeText({text:""});var u=$("#showList li[locked]").removeAttr("locked");
setTimeout(function(){u.attr("locked","");},0);});$(document).on("mousedown","#hideList>li, #showList>li",function(x){var w=$(this),A=w.data("id"),z=w.attr("locked")!=undefined,v=w.data("optionurl"),u=w.data("homepageurl"),y=$("[data-right]");
if(y.length>0&&y.data("id")===A){c();}if(x.button===2&&w.hasClass("hover")&&q){j.removeClass("extName-anim").attr("style","").empty();w.attr("data-right","");
g.css({"background-color":p[A]?p[A].color:t,top:p[A].top,left:p[A].left1}).show();if(z){g.find("li.lock").attr("locked","");}else{g.find("li.lock").removeAttr("locked");
}if(!!$.trim(v)){g.find("li.option").removeAttr("disabled");}else{g.find("li.option").attr("disabled","");}if(!!$.trim(u)){g.find("li.homepage").removeAttr("disabled");
}else{g.find("li.homepage").attr("disabled","");}setTimeout(function(){g.css({left:p[A].left2,opacity:1});},0);}});$(document).on("contextmenu",function(u){return false;
});$("#rightMenu").on("click","li",function(x){x.preventDefault();x.stopPropagation();var v=$(this),u=$("[data-right]"),y=u.attr("data-id");c();switch(v.attr("class")){case"lock":var w=k();
if(v.attr("locked")===undefined){u.attr("locked","");w[y]="1";}else{u.removeAttr("locked");delete w[y];}localStorage.setItem("_lockList_",JSON.stringify(w));
l();break;case"option":if(v.attr("disabled")===undefined){chrome.tabs.create({url:u.data("optionurl")});}break;case"homepage":if(v.attr("disabled")===undefined){chrome.tabs.create({url:u.data("homepageurl")});
}break;case"uninstall":chrome.management.uninstall(y,function(){});break;default:break;}});function k(){var u=localStorage.getItem("_lockList_");if(u){return JSON.parse(u);
}else{return{};}}var p={};function a(x,v){function w(G){var B=document.getElementById("getColorByCanvas");B.width=G.width;B.height=G.height;var A=B.getContext("2d");
A.drawImage(G,0,0);var F=A.getImageData(0,0,G.width,G.height).data;var z=0;var H=0;var J=0;var E=180;var L=1000;for(var M=0;M<G.height;M++){for(var D=0;
D<G.width;D++){var C=F[((G.width*M)+D)*4];var y=F[((G.width*M)+D)*4+1];var K=F[((G.width*M)+D)*4+2];if(C!=255&&y!=255&&K!=255){if(D<L){L=D;}}if(!(C>E&&y>E&&K>E)){z+=C;
H+=y;J+=K;}}}z/=(G.width*G.height);H/=(G.width*G.height);J/=(G.width*G.height);z=Math.round(z);H=Math.round(H);J=Math.round(J);var I="rgb("+z+","+H+","+J+")";
if(z>E&&H>E&&J>E){I=t;}if(L===1000){setTimeout(function(){$("[data-id="+v+"]").css({"background-image":"url("+s+")"});},0);I=t;}return{color:I,substantial:L};
}var u=new Image();u.crossOrigin="Anonymous";u.src=x;u.onload=function(){var y=w(u);if(!p[v]){p[v]={};}p[v]["color"]=y.color;p[v]["substantial"]=y.substantial;
};}})();