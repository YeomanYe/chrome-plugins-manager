(function(){document.title=chrome.i18n.getMessage("extName");$("#tips").attr("data-lan",chrome.i18n.getMessage("@@ui_locale"));$("#tips .title").html(chrome.i18n.getMessage("tipsTitle"));
$("#tips .con").html(chrome.i18n.getMessage("tipsCon"));$("#rightMenu li.option").html(chrome.i18n.getMessage("rightOption"));$("#rightMenu li.uninstall").html(chrome.i18n.getMessage("rightUninstall"));
$("#rightMenu li.homepage").html(chrome.i18n.getMessage("rightHomepage"));var b=$("#tips .url");b.html(chrome.i18n.getMessage("tipsUrl"));b.attr("href",b.attr("href")+chrome.i18n.getMessage("@@ui_locale"));
var d=$("#showList");var n=$("#hideList");var f=$("#wrap");var j=localStorage.getItem("_switch_show_extname_")!=="close";var q=localStorage.getItem("_switch_right_more_")!=="close";
var k=$("#extName");var h=$("#rightMenu");var t="#5c5e6f";var s="../icon/default-icon.png";var i={3:228,4:304,5:380,6:456,7:532,8:608,9:684};f.width(i[localStorage.getItem("_showColumn_")]);
var p=localStorage.getItem("_showIconSize_")||2;f.addClass("icon-size-"+p);function o(){var u=l();chrome.management.getAll(function(C){var v=[];var D=[];
var w=[];for(var y=0;y<C.length;y++){var x=C[y];if(x.id===chrome.app.getDetails().id||x.type==="theme"){continue;}var z="";if(x.icons&&x.icons.length>0){z=x.icons[x.icons.length-1].url;
}else{z=s;}var A="";if(u&&u[x.id]==1){A="locked";}var B='<li data-id="'+x.id+'" data-homepageurl="'+x.homepageUrl+'" data-optionurl="'+x.optionsUrl+'" data-name="'+x.shortName+'" style="background-image:url('+z+')" '+A+"></li>";
if(j&&x.icons&&x.icons.length>0){(function(F,G){setTimeout(function(){a(F,G.id);},0);})(x.icons[0].url,x);}if(x.enabled===false){w.push(B);}else{if(A==="locked"){D.unshift(B);
}else{v.push(B);}}}if(!localStorage.getItem("_switch_rank_sort_")){v.sort(function(F,G){return r.get($(G).data("id"))-r.get($(F).data("id"));});w.sort(function(F,G){return r.get($(G).data("id"))-r.get($(F).data("id"));
});}var E=D.concat(v);d.html(E.join(""));if(w.length===0){d.addClass("hideListIsNull");if(E.length===0){f.addClass("allListIsEmpty");}}n.html(w.join(""));
setTimeout(function(){$("body").css("background-color","#fff");f.width(f.width()+1);},200);m();});}o();function m(){if(!localStorage.getItem("_switch_show_badge_")){var v=l();
var u=0;$("#showList li").each(function(w,x){var y=$(x).data("id");if(v&&v[y]!=="1"){u++;}});if(u===0){chrome.browserAction.setBadgeText({text:""});}else{chrome.browserAction.setBadgeBackgroundColor({color:"#f44336"});
chrome.browserAction.setBadgeText({text:u+""});}}}var r={_key:"_rankList_",_getLocalStorage:function(){var v=localStorage.getItem(this._key),u=null;if(v){u=JSON.parse(v);
return u;}else{return{};}},_setLocalStorage:function(u){localStorage.setItem(this._key,JSON.stringify(u));},get:function(v){var u=this._getLocalStorage();
if(u&&u[v]){return parseInt(u[v]);}else{return 0;}},setRank:function(w){var u=this._getLocalStorage();if(u){var v=u[w];if(v){u[w]=parseInt(u[w])+1;}else{u[w]=1;
}this._setLocalStorage(u);}}};f.on("click","li",function(w){w.preventDefault();w.stopPropagation();var v=$(this),x=v.data("id"),u=v.closest("#hideList").length===1;
if(x){v.removeClass("hover");k.removeClass("extName-anim").attr("style","").empty();if(u){d.append(v);r.setRank(x);}else{n.append(v);}v.attr("data-leftClick",(new Date)*1);
if(n.find("li").length===0){d.addClass("hideListIsNull");}else{d.removeClass("hideListIsNull");}chrome.management.setEnabled(x,u,function(){});}m();});
function c(){var u=$("[data-right]");if(u.length>0){u.removeAttr("data-right").removeClass("hover");h.removeAttr("style");$(".dinginess").removeClass("dinginess");
}k.removeClass("extName-anim").attr("style","").empty();}$(document).on("click",function(){c();});var g={"1":18,"2":22,"3":26};f.on("mouseenter","li",function(){var C=$(this),u=C.attr("data-id");
var w=$("[data-right]"),B=w.attr("data-id");if(u===B){return false;}if(w.length>0){w.removeAttr("data-right").removeClass("hover");h.removeAttr("style");
var A=C.closest("#showList").length>0?$("#hideList"):$("#showList");A.removeClass("dinginess");}if(j){var D=C.offset();var x=D.left+50-10;var z=x+g[p];
var v=k.html(C.attr("data-name")).outerWidth();if($("body").width()<v+z){x=D.left-v+10;z=x-g[p];}if(e[u]){k.css("background-color",e[u].color);}k.css({top:D.top+15,left:x});
}var y=C.closest(".list");clearTimeout(window["timer_disable_dinginess_"+y.attr("id")]);window["timer_"+C.data("id")]=setTimeout(function(){if((new Date)*1<(C.attr("data-leftclick")*1+200)){return;
}C.addClass("hover");if(j){y.addClass("dinginess");k.addClass("extName-anim").css({left:z,opacity:1});}},100);}).on("mouseleave","li",function(){var u=$(this),v=u.closest(".list");
if(u.attr("data-right")!=undefined){return false;}if(j){window["timer_disable_dinginess_"+v.attr("id")]=setTimeout(function(){v.removeClass("dinginess");
},300);k.removeClass("extName-anim").attr("style","").empty();}u.removeClass("hover");clearTimeout(window["timer_"+u.data("id")]);});function l(){var u=localStorage.getItem("_lockList_");
if(u){return JSON.parse(u);}else{return null;}}$("body").on("dblclick",function(){var u=d.find("li");u.each(function(v,x){var w=$(x);var y=w.data("id");
if(w.attr("locked")===""){return;}n.append(w);chrome.management.setEnabled(y,false,function(){});});chrome.browserAction.setBadgeText({text:""});});$(document).on("mousedown","#hideList>li, #showList>li",function(x){var D=$(this),v=D.data("id"),u=D.attr("locked")!=undefined,A=D.data("optionurl"),z=D.data("homepageurl"),C=$("[data-right]");
if(C.length>0&&C.data("id")===v){c();}if(x.button===2&&D.hasClass("hover")&&q){k.removeClass("extName-anim").attr("style","").empty();D.attr("data-right","");
var E=D.offset();var w=E.left+0.15*50+50-10;var y=w+g[p];var B=h.outerWidth();if($("body").width()<B+y){w=E.left+0.15*50-B+10;y=w-g[p];}h.css({"background-color":e[v]?e[v].color:t,top:E.top+(50*1.3-52)/2,left:w}).show();
if(u){h.find("li.lock").attr("locked","");}else{h.find("li.lock").removeAttr("locked");}if(!!$.trim(A)){h.find("li.option").removeAttr("disabled");}else{h.find("li.option").attr("disabled","");
}if(!!$.trim(z)){h.find("li.homepage").removeAttr("disabled");}else{h.find("li.homepage").attr("disabled","");}setTimeout(function(){h.css({left:y,opacity:1});
},0);}});$(document).on("contextmenu",function(u){return false;});$("#rightMenu").on("click","li",function(x){x.preventDefault();x.stopPropagation();var v=$(this),u=$("[data-right]"),y=u.attr("data-id");
c();switch(v.attr("class")){case"lock":var w=l();if(v.attr("locked")===undefined){u.attr("locked","");w[y]="1";}else{u.removeAttr("locked");delete w[y];
}localStorage.setItem("_lockList_",JSON.stringify(w));break;case"option":if(v.attr("disabled")===undefined){chrome.tabs.create({url:u.data("optionurl")});
}break;case"homepage":if(v.attr("disabled")===undefined){chrome.tabs.create({url:u.data("homepageurl")});}break;case"uninstall":chrome.management.uninstall(y,function(){});
break;default:break;}});function l(){var u=localStorage.getItem("_lockList_");if(u){return JSON.parse(u);}else{return{};}}var e={};function a(x,v){function w(G){var B=document.getElementById("getColorByCanvas");
B.width=G.width;B.height=G.height;var A=B.getContext("2d");A.drawImage(G,0,0);var F=A.getImageData(0,0,G.width,G.height).data;var z=0;var H=0;var J=0;var E=180;
var L=1000;for(var M=0;M<G.height;M++){for(var D=0;D<G.width;D++){var C=F[((G.width*M)+D)*4];var y=F[((G.width*M)+D)*4+1];var K=F[((G.width*M)+D)*4+2];
if(C!=255&&y!=255&&K!=255){if(D<L){L=D;}}if(!(C>E&&y>E&&K>E)){z+=C;H+=y;J+=K;}}}z/=(G.width*G.height);H/=(G.width*G.height);J/=(G.width*G.height);z=Math.round(z);
H=Math.round(H);J=Math.round(J);var I="rgb("+z+","+H+","+J+")";if(z>E&&H>E&&J>E){I=t;}if(L===1000){setTimeout(function(){$("[data-id="+v+"]").css({"background-image":"url("+s+")"});
},0);I=t;}return{color:I,substantial:L};}var u=new Image();u.crossOrigin="Anonymous";u.src=x;u.onload=function(){var y=w(u);e[v]=y;};}setTimeout(function(){if(f.outerWidth()>$(window).width()){f.attr("showTips","");
}},1000);})();